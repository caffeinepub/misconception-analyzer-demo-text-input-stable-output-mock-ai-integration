{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Ensure Gemini analysis is performed only via backend and prevent API key exposure",
  "requirements": [
    {
      "id": "REQ-2",
      "summary": "Ensure the frontend never calls Gemini directly or exposes the Gemini API key, while rendering backend analysis results and preserving fallback disclosure behavior.",
      "acceptanceCriteria": [
        "No frontend code path performs a direct Gemini request from the browser.",
        "The Gemini API key string does not appear in any frontend source/bundle output.",
        "When analysis succeeds via backend, the UI shows the backend result (no fallback disclosure prefix is added).",
        "If backend analysis fails, the existing fallback behavior in `frontend/src/hooks/useQueries.ts` continues to work and clearly discloses fallback usage."
      ],
      "file_operations": [
        {
          "path": "frontend/src/hooks/useQueries.ts",
          "operation": "modify",
          "description": "Enforce the browser-side analysis flow to call only the backend canister actor method for analysis (no direct Gemini/browser networking), validate the backend response shape before returning it to the UI (without adding fallback disclosure on success), and preserve the existing deterministic mock fallback behavior with clear disclosure when backend analysis fails or is unavailable."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Confirm the UI renders analysis results exactly as returned by the analysis hook (no added prefixes or Gemini-specific messaging on success) and keeps all user-facing text in English, ensuring backend results are displayed as-is and fallback disclosure remains visible when present in the returned text."
        }
      ]
    }
  ]
}